<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>Glow Up Analyzer</title>

<style>
body{
  font-family: system-ui, Arial;
  max-width:700px;
  margin:40px auto;
  padding:20px;
  text-align:center;
}

.box{
  border:2px dashed #ccc;
  padding:30px;
  border-radius:14px;
}

button{
  padding:14px 26px;
  border:none;
  border-radius:10px;
  font-size:16px;
  cursor:pointer;
  margin-top:15px;
}

.analyze{
  background:#b87b6b;
  color:white;
}

.glow{
  background:#667fb8;
  color:white;
  display:none;
}

.download{
  background:#2f7d48;
  color:white;
  display:none;
}

#preview{
  max-width:280px;
  border-radius:14px;
  margin-top:15px;
  display:none;
}

#result{
  margin-top:30px;
  text-align:left;
}
</style>
</head>


<body>

<h2>Your Personalized Glow-Up Plan ✨</h2>

<div class="box">
  <input type="file" id="imageInput" accept="image/*" />
  <br>

  <button class="analyze" onclick="analyze()">Analyze My Photo</button>
  <br>

  <button id="glowBtn" class="glow" onclick="generateGlow()">
    See My Glow-Up Photo ✨
  </button>
</div>

<img id="preview">

<button id="downloadBtn" class="download">
  Download My Glow-Up Photo
</button>

<div id="result"></div>


<script>
let savedFile;


// ========================
// ANALYZE PHOTO (TEXT RESULTS)
// ========================
async function analyze(){

  const file = document.getElementById("imageInput").files[0];
  if(!file) return alert("Upload a photo first!");

  savedFile = file;

  const formData = new FormData();
  formData.append("image", file);

  const resultDiv = document.getElementById("result");
  resultDiv.innerHTML = "Analyzing your photo...";

  const res = await fetch(
    "https://lwfs-glowup.lisa-668.workers.dev",
    {
      method:"POST",
      body:formData
    }
  );

  const html = await res.text();
  resultDiv.innerHTML = html;

  document.getElementById("glowBtn").style.display="inline-block";
}



// ========================
// GENERATE GLOW-UP IMAGE
// ========================
async function generateGlow(){

  const formData = new FormData();
  formData.append("image", savedFile);

  const preview = document.getElementById("preview");
  preview.style.display="block";
  preview.src="Generating glow-up...";

  const res = await fetch(
    "https://lwfs-glowup.lisa-668.workers.dev?glow=1",
    {
      method:"POST",
      body:formData
    }
  );

  const blob = await res.blob();
  const url = URL.createObjectURL(blob);

  preview.src = url;

  const downloadBtn = document.getElementById("downloadBtn");
  downloadBtn.style.display="inline-block";

  downloadBtn.onclick = () => {
    const a = document.createElement("a");
    a.href = url;
    a.download = "my-glow-up.png";
    a.click();
  };
}
</script>

</body>
</html>

